"use strict";angular.module("btford.socket-io",[]).provider("socketFactory",function(){var defaultPrefix="socket:";this.$get=["$rootScope","$timeout",function($rootScope,$timeout){var asyncAngularify=function(socket,callback){return callback?function(){var args=arguments;$timeout(function(){callback.apply(socket,args)},0)}:angular.noop};return function(options){options=options||{};var socket=options.ioSocket||io.connect(),prefix=void 0===options.prefix?defaultPrefix:options.prefix,defaultScope=options.scope||$rootScope,addListener=function(eventName,callback){socket.on(eventName,callback.__ng=asyncAngularify(socket,callback))},addOnceListener=function(eventName,callback){socket.once(eventName,callback.__ng=asyncAngularify(socket,callback))},wrappedSocket={on:addListener,addListener:addListener,once:addOnceListener,emit:function(eventName,data,callback){var lastIndex=arguments.length-1,callback=arguments[lastIndex];return"function"==typeof callback&&(callback=asyncAngularify(socket,callback),arguments[lastIndex]=callback),socket.emit.apply(socket,arguments)},removeListener:function(ev,fn){return fn&&fn.__ng&&(arguments[1]=fn.__ng),socket.removeListener.apply(socket,arguments)},removeAllListeners:function(){return socket.removeAllListeners.apply(socket,arguments)},disconnect:function(close){return socket.disconnect(close)},connect:function(){return socket.connect()},forward:function(events,scope){events instanceof Array==!1&&(events=[events]),scope||(scope=defaultScope),events.forEach(function(eventName){var prefixedEvent=prefix+eventName,forwardBroadcast=asyncAngularify(socket,function(){Array.prototype.unshift.call(arguments,prefixedEvent),scope.$broadcast.apply(scope,arguments)});scope.$on("$destroy",function(){socket.removeListener(eventName,forwardBroadcast)}),socket.on(eventName,forwardBroadcast)})}};return wrappedSocket}}]});var Lawnchair=function(options,callback){if(!(this instanceof Lawnchair))return new Lawnchair(options,callback);if(!JSON)throw"JSON unavailable! Include http://www.json.org/json2.js to fix.";if(!(arguments.length<=2&&arguments.length>0))throw"Incorrect # of ctor args!";if(callback="function"==typeof arguments[0]?arguments[0]:arguments[1],options="function"==typeof arguments[0]?{}:arguments[0],"function"!=typeof callback)throw"No callback was provided";this.record=options.record||"record",this.name=options.name||"records";var adapter;if(options.adapter){for(var i=0,l=Lawnchair.adapters.length;l>i;i++)if(Lawnchair.adapters[i].adapter===options.adapter){adapter=Lawnchair.adapters[i].valid()?Lawnchair.adapters[i]:void 0;break}}else for(var i=0,l=Lawnchair.adapters.length;l>i&&!(adapter=Lawnchair.adapters[i].valid()?Lawnchair.adapters[i]:void 0);i++);if(!adapter)throw"No valid adapter.";for(var j in adapter)this[j]=adapter[j];for(var i=0,l=Lawnchair.plugins.length;l>i;i++)Lawnchair.plugins[i].call(this);this.init(options,callback)};Lawnchair.adapters=[],Lawnchair.adapter=function(id,obj){obj.adapter=id;var implementing="adapter valid init keys save batch get exists all remove nuke".split(" "),indexOf=this.prototype.indexOf;for(var i in obj)if(-1===indexOf(implementing,i))throw"Invalid adapter! Nonstandard method: "+i;Lawnchair.adapters.splice(0,0,obj)},Lawnchair.plugins=[],Lawnchair.plugin=function(obj){for(var i in obj)"init"===i?Lawnchair.plugins.push(obj[i]):this.prototype[i]=obj[i]},Lawnchair.prototype={isArray:Array.isArray||function(o){return"[object Array]"===Object.prototype.toString.call(o)},indexOf:function(ary,item,i,l){if(ary.indexOf)return ary.indexOf(item);for(i=0,l=ary.length;l>i;i++)if(ary[i]===item)return i;return-1},lambda:function(callback){return this.fn(this.record,callback)},fn:function(name,callback){return"string"==typeof callback?new Function(name,callback):callback},uuid:function(){var S4=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return S4()+S4()+"-"+S4()+"-"+S4()+"-"+S4()+"-"+S4()+S4()+S4()},each:function(callback){var cb=this.lambda(callback);if(this.__results)for(var i=0,l=this.__results.length;l>i;i++)cb.call(this,this.__results[i],i);else this.all(function(r){for(var i=0,l=r.length;l>i;i++)cb.call(this,r[i],i)});return this}},Lawnchair.adapter("dom",function(){var storage=window.localStorage,indexer=function(name){return{key:name+"._index_",all:function(){var a=storage.getItem(this.key);return a&&(a=JSON.parse(a)),null===a&&storage.setItem(this.key,JSON.stringify([])),JSON.parse(storage.getItem(this.key))},add:function(key){var a=this.all();a.push(key),storage.setItem(this.key,JSON.stringify(a))},del:function(key){for(var a=this.all(),r=[],i=0,l=a.length;l>i;i++)a[i]!=key&&r.push(a[i]);storage.setItem(this.key,JSON.stringify(r))},find:function(key){for(var a=this.all(),i=0,l=a.length;l>i;i++)if(key===a[i])return i;return!1}}};return{valid:function(){return!!storage},init:function(options,callback){this.indexer=indexer(this.name),callback&&this.fn(this.name,callback).call(this,this)},save:function(obj,callback){var key=obj.key?this.name+"."+obj.key:this.name+"."+this.uuid();return this.indexer.find(key)===!1&&this.indexer.add(key),delete obj.key,storage.setItem(key,JSON.stringify(obj)),obj.key=key.slice(this.name.length+1),callback&&this.lambda(callback).call(this,obj),this},batch:function(ary,callback){for(var saved=[],i=0,l=ary.length;l>i;i++)this.save(ary[i],function(r){saved.push(r)});return callback&&this.lambda(callback).call(this,saved),this},keys:function(callback){if(callback){var name=this.name,keys=this.indexer.all().map(function(r){return r.replace(name+".","")});this.fn("keys",callback).call(this,keys)}return this},get:function(key,callback){if(this.isArray(key)){for(var r=[],i=0,l=key.length;l>i;i++){var k=this.name+"."+key[i],obj=storage.getItem(k);obj&&(obj=JSON.parse(obj),obj.key=key[i],r.push(obj))}callback&&this.lambda(callback).call(this,r)}else{var k=this.name+"."+key,obj=storage.getItem(k);obj&&(obj=JSON.parse(obj),obj.key=key),callback&&this.lambda(callback).call(this,obj)}return this},exists:function(key,cb){var exists=this.indexer.find(this.name+"."+key)===!1?!1:!0;return this.lambda(cb).call(this,exists),this},all:function(callback){for(var o,k,idx=this.indexer.all(),r=[],i=0,l=idx.length;l>i;i++)k=idx[i],o=JSON.parse(storage.getItem(k)),o.key=k.replace(this.name+".",""),r.push(o);return callback&&this.fn(this.name,callback).call(this,r),this},remove:function(keyOrObj,callback){var key=this.name+"."+(keyOrObj.key?keyOrObj.key:keyOrObj);return this.indexer.del(key),storage.removeItem(key),callback&&this.lambda(callback).call(this),this},nuke:function(callback){return this.all(function(r){for(var i=0,l=r.length;l>i;i++)this.remove(r[i]);callback&&this.lambda(callback).call(this)}),this}}}()),angular.module("jrg",["jackrabbitsgroup.angular-string","jackrabbitsgroup.angular-array","jackrabbitsgroup.angular-forminput"]),angular.module("models",[]),angular.module("app",["models"]),angular.module("myApp",["ngRoute","ngSanitize","ngTouch","ngAnimate","ngCookies","ui.bootstrap","btford.socket-io","jrg","app"]).config(["$routeProvider","$locationProvider","appConfigProvider","$compileProvider",function($routeProvider,$locationProvider,appConfigProvider,$compileProvider){$compileProvider.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|file|tel|content|geo|http?):/);var appPath=appConfigProvider.dirPaths.appPath,staticPath=appConfigProvider.dirPaths.staticPath,appPathRoute=appPath,html5History=!(!window.history||!window.history.pushState),ua=navigator.userAgent;if("undefined"!=typeof globalPhoneGap&&globalPhoneGap===!0)html5History=!1;else if(ua.indexOf("PhantomJS")>=0)html5History=!1;else if(ua.indexOf("Android")>=0){var androidversion=parseFloat(ua.slice(ua.indexOf("Android")+8));3>androidversion&&(html5History=!1)}html5History?$locationProvider.html5Mode(!0):(appPathRoute="/",appConfigProvider.dirPaths.appPathLink=appConfigProvider.dirPaths.appPathLink+"#/",appConfigProvider.dirPaths.appPathLocation="");var pagesPath=staticPath+"modules/pages/";$routeProvider.when(appPathRoute+"home",{redirectTo:appPathRoute+"dev-test/test"}),$routeProvider.when(appPathRoute+"login",{templateUrl:pagesPath+"login/login.html",resolve:{auth:function(appAuth){return appAuth.checkSess({})}}}),$routeProvider.when(appPathRoute+"signup",{templateUrl:pagesPath+"signup/signup.html",resolve:{auth:function(appAuth){return appAuth.checkSess({})}}}),$routeProvider.when(appPathRoute+"logout",{templateUrl:pagesPath+"logout/logout.html",resolve:{auth:function(appAuth){return appAuth.checkSess({})}}}),$routeProvider.when(appPathRoute+"user-delete",{templateUrl:pagesPath+"userDelete/user-delete.html",resolve:{auth:function(appAuth){return appAuth.checkSess({})}}}),$routeProvider.when(appPathRoute+"password-reset",{templateUrl:pagesPath+"passwordReset/password-reset.html",resolve:{auth:function(appAuth){return appAuth.checkSess({})}}}),$routeProvider.when(appPathRoute+"callback-twitter-auth",{templateUrl:pagesPath+"callback/callback-twitter-auth/callback-twitter-auth.html",resolve:{auth:function(appAuth){return appAuth.checkSess({})}}}),$routeProvider.when(appPathRoute+"callback-facebook-auth",{templateUrl:pagesPath+"callback/callback-facebook-auth/callback-facebook-auth.html",resolve:{auth:function(appAuth){return appAuth.checkSess({})}}}),$routeProvider.when(appPathRoute+"callback-google-auth",{templateUrl:pagesPath+"callback/callback-google-auth/callback-google-auth.html",resolve:{auth:function(appAuth){return appAuth.checkSess({})}}}),$routeProvider.when(appPathRoute+"dev-test/test",{templateUrl:pagesPath+"dev-test/test/test.html",resolve:{auth:function(appAuth){return appAuth.checkSess({})}}}),$routeProvider.when(appPathRoute+"dev-test/design",{templateUrl:pagesPath+"dev-test/design/design.html",resolve:{auth:function(appAuth){return appAuth.checkSess({})}}}),$routeProvider.when(appPathRoute+"dev-test/socketio",{templateUrl:pagesPath+"dev-test/socketio/socketio.html",resolve:{auth:function(appAuth){return appAuth.checkSess({})}}}),$routeProvider.when(appPathRoute+"dev-test/social",{templateUrl:pagesPath+"dev-test/social/social.html",resolve:{auth:function(appAuth){return appAuth.checkSess({})}}}),$routeProvider.when(appPathRoute+"dev-test/e2e",{templateUrl:pagesPath+"dev-test/e2e/e2e.html",resolve:{auth:function(appAuth){return appAuth.checkSess({})}}}),$routeProvider.otherwise({redirectTo:appPathRoute+"home"})}]),angular.module("models").factory("UserModel",["appStorage",function(appStorage){var inst={data:{},init:function(params){this.data={_id:!1}},destroy:function(params){this.data={}},save:function(data,params){this.data=angular.extend(this.data,data),appStorage.save("user",this.data,{})},load:function(key,params){return key&&"all"!=key?this.data[key]:this.data}};return inst.init(),inst}]),angular.module("app").provider("appConfig",function(){this.server="",this.dirPaths={appPath:"/",appPathLink:"/",appPathLocation:"/",staticPath:"/src/",pagesPath:"modules/pages/",rootPath:"/",serverUrl:"http://localhost/",serverPath:"http://localhost:3000/",publicPath:"http://localhost:3000/",homeDirectory:!1,images:"common/img/",uploads:"uploads/",ajaxUrlParts:{main:"http://localhost:3000/"},ajaxUrl:{api:"http://localhost:3000/api/"},useCorsUrls:{all:0}},this.info={timezone:{name:"",offset:"",minutes:""}},this.data={},this.state={loggedIn:!1},this.cfgJson={},this.$get=function(){return{hosts:this.hosts,dirPaths:this.dirPaths,info:this.info,data:this.data,state:this.state,cfgJson:this.cfgJson,load:function(key,params){var defaults={mainKey:"data"};params=angular.extend(defaults,params);var val=!1;return void 0!==this[params.mainKey][key]&&(val=this[params.mainKey][key]),val},save:function(key,value,params){var defaults={mainKey:"data"};params=angular.extend(defaults,params),this[params.mainKey][key]=value}}},this.init=function(params){this.dirPaths.images=this.dirPaths.staticPath+this.dirPaths.images,this.dirPaths.uploads=this.dirPaths.appPath+this.dirPaths.uploads,this.dirPaths.homeDirectory=this.dirPaths.serverUrl;var getOffsetFromMinutes=function(minutesTotal,params){var ret={z:"",minutes:minutesTotal},posNeg="+";0>minutesTotal&&(posNeg="-",minutesTotal=-1*minutesTotal);var hours=Math.floor(minutesTotal/60).toString(),minutes=(minutesTotal%60).toString();return 1==hours.length&&(hours="0"+hours),1==minutes.length&&(minutes="0"+minutes),ret.z=posNeg+hours+":"+minutes,ret},minutesTotal=(new Date).getTimezoneOffset(),ret1=getOffsetFromMinutes(minutesTotal,{});this.info.timezone.offset=ret1.z,this.info.timezone.minutes=ret1.minutes,this.cfgJson={versions:{cfg:"0.0.0",pkg:"0.0.0"},env:"development",operatingSystem:"mac",operatingSystemComment:"One of: 'windows', 'mac', 'linux'",forever:0,foreverOptions:{logfile:"forever.log"},app:{name:"AndSheCodes2",title:"AndSheCodes2"},platform:"",server:{domain:"localhost",scheme:"http",port:3e3,_vanityPortStringComment:"E.g. ':3000' or blank '' for no port - set an optional 'vanityPortString' key for port 80 redirects for production sites to hide port for social logins, user communication, etc.",_httpsPort:443,httpPort:3002,httpRedirectPort:3e3,_httpRedirectPortComment:"set to 'false' to have no port - i.e. for production use with iptables routing",socketIOEnabled:!0,_socketPort:3001,_socketPortComment:"Must be same port with express?",socketPort:3e3,serverPath:"/",appPath:"/",staticFilePath:"/src/",staticPath:"/src/"},cors:{domains:["localhost"],frontendUseCors:0},db:{fullURI:"",host:"localhost",port:27017,database:"AndSheCodes2",username:!1,password:!1},logKey:"dev",cookie:{secret:"o@:&M<ZN PF(s.T)3?*;^1~TDjNE}=3xy$SpB7dE%dA-}fAn.b[RRU{cg+P#[):/"},ssl:{enabled:!1,key:"/ssl/ssl.key",cert:"/ssl/ssl.crt",ca:[]},rpc:{autoDoc:!0,autoDocUrl:"help"},test_coverage:{jasmine_node:{failTask:!0,branches:35,functions:55,statements:55,lines:55},angular_karma:{branches:85,functions:85,statements:85,lines:85}},ci:{server:{port:3009,portCiServer:3010},emails_failed:[]},less:{dirPathRootPrefix:""},email:{domain:"localhost",addresses:{noReply:"noreply"},from:"admin@AndSheCodes2.com",from_name:"Admin",mandrillApiKey:"8X-1bNRWtA4rbneppkqahw",mandrillApiKeyComment:"Make sure to CHANGE this!"},sms:{},facebook:{scope:"email,user_birthday,publish_actions",appId:"195380783916970",appSecret:"4690b0f547b8cbe114dc84abab150c10",_comment:"Make sure to CHANGE / set appId and appSecret!"},twitter:{consumerKey:"4wTFTzPvchVYAECdulQBCVcpk",consumerSecret:"Sq1UeJbL4PSf5WyP6TUkAt8uFIxTFvzf2D8IBkvkZriu0WV0vr",consumerComment:"Make sure to CHANGE the key and secret!",callback_url:"http://127.0.0.1:3000/callback-twitter-auth",handle:""},google:{clientId:"486630891328.apps.googleusercontent.com",clientIdComment:"Make sure to CHANGE this!",clientSecret:"uKWzHKd9hbF4dxCmxefrpkYh",callback_url:"http://localhost:3000/callback-google-auth"},sauceLabs:{user:"",key:""},browserstack:{user:"",access_key:""},e2e:{facebook:{logins:[{email:"vbrnszo_smithwitz_1409165870@tfbnw.net",password:"testing"}]},twitter:{logins:[{username:"TestingOne3",password:"testing123"}]},google:{logins:[{email:"meanseed1@gmail.com",password:"meanseed11"}]},_run_type_comment:"One of: 'none' for NO e2e tests in default test/grunt task, 'single' (or undefined) for the default single (chrome) platform test, 'parallel' for running multiple tests"}},void 0!==this.cfgJson.server.vanityPortString&&(this.dirPaths.publicPath=this.cfgJson.server.scheme+"://"+this.cfgJson.server.domain+this.cfgJson.server.vanityPortString+"/")},this.init()}),angular.module("app").factory("appHttp",["$http","$q","$rootScope","$cookieStore","appConfig","$timeout","appStorage","appErrorMsg",function($http,$q,$rootScope,$cookieStore,appConfig,$timeout,appStorage,appErrorMsg){var inst={timeoutTrigs:{},go:function(rpcOpts,httpOpts,params){var self=this,defaults={maxMilliseconds:7500};params=angular.extend(defaults,params);var methodUrl;void 0!==httpOpts.url?methodUrl=httpOpts.url:void 0!==rpcOpts.method&&(methodUrl=rpcOpts.method.toLowerCase().replace(".","/"));var instId=Math.random().toString(36).substring(7);void 0!==params.noLoadingScreen&&params.noLoadingScreen||$rootScope.$broadcast("evtLoadingStart",{});var deferred=$q.defer();return this.formConfig(rpcOpts,httpOpts,params).then(function(httpOpts){$http(httpOpts).success(function(response){if($timeout.cancel(self.timeoutTrigs[instId]),response.hasOwnProperty("error")){if(void 0===params.suppressErrorAlert||!params.suppressErrorAlert){var msg,code=response.error.code;void 0!==response.error.message&&void 0!==response.error.message.code&&(code=response.error.message.code),msg=response.error.message,void 0!==response.error.message&&void 0!==response.error.message.msg&&(msg=response.error.message.msg);var retMsg=appErrorMsg.getMessage(methodUrl,code,{});retMsg.found&&(msg=retMsg.msg),$rootScope.$broadcast("evtAppalertAlert",{type:"error",msg:msg})}deferred.reject(response)}else params.msgSuccess&&$rootScope.$broadcast("evtAppalertAlert",{type:"success",msg:params.msgSuccess}),deferred.resolve(response);void 0!==params.noLoadingScreen&&params.noLoadingScreen||$rootScope.$broadcast("evtLoadingDone",{})}).error(function(response,status){$timeout.cancel(self.timeoutTrigs[instId]);var msg="Error ";0!==status&&status&&response?void 0!==response.msg?msg+=response.msg+" ":401==status?(void 0!==response.status&&(msg+=response.status+". "),msg+=" Try logging out and logging in again to refresh your session if you think you should have access to this content. Note that everytime you log in on another device or browser your session is reset everywhere else for security purposes."):msg+=status+", "+JSON.stringify(response):msg+=" No server response - try checking your internet connection and trying again. If the problem persists please let us know and we'll look into it!",$rootScope.$broadcast("evtAppalertAlert",{type:"error",msg:msg}),deferred.reject(response),void 0!==params.noLoadingScreen&&params.noLoadingScreen||$rootScope.$broadcast("evtLoadingDone",{})}),self.timeoutTrigs[instId]=$timeout(function(){$rootScope.$broadcast("evtAppalertAlert",{type:"error",msg:"Call is taking too long so was canceled; please check your internet connection and try again later"}),deferred.reject({msg:"call timeout - taking too long"}),void 0!==params.noLoadingScreen&&params.noLoadingScreen||$rootScope.$broadcast("evtLoadingDone",{})},params.maxMilliseconds)}),$rootScope.$$phase||$rootScope.$apply(),deferred.promise},formConfig:function(rpcOpts,httpOpts,params){var deferred=$q.defer();void 0!==rpcOpts.method&&(httpOpts.url=rpcOpts.method.slice(0,rpcOpts.method.indexOf(".")).toLowerCase()+"/");var defaultHttpOpts={method:"POST",params:{},data:{}};httpOpts=angular.extend(defaultHttpOpts,httpOpts);var urlPrefix=this.formHost({})+"api/";return httpOpts.url=urlPrefix+httpOpts.url,this.addParams(httpOpts,{}).then(function(httpOpts){httpOpts.data={jsonrpc:"2.0",id:1,method:rpcOpts.method,params:httpOpts.data},"GET"===httpOpts.method.toUpperCase()?httpOpts.params={rpc:httpOpts.data}:delete httpOpts.params,deferred.resolve(httpOpts)}),deferred.promise},addParams:function(httpOpts,params){var deferred=$q.defer(),authObj=!1,cookieSess=$cookieStore.get("sess_id"),cookieUser=$cookieStore.get("user_id");if(cookieSess&&cookieUser)authObj={user_id:cookieUser,sess_id:cookieSess},httpOpts.params.authority_keys=authObj,httpOpts.data.authority_keys=authObj,deferred.resolve(httpOpts);else{var promiseStorage=appStorage.read("user",{});promiseStorage.then(function(user){authObj={user_id:user._id,sess_id:user.sess_id},httpOpts.params.authority_keys=authObj,httpOpts.data.authority_keys=authObj,deferred.resolve(httpOpts)},function(err){deferred.resolve(httpOpts)})}return deferred.promise},formHost:function(params){var host="/";return parseInt(appConfig.dirPaths.useCorsUrls.all,10)&&($http.defaults.headers.common["X-Requested-With"]=void 0,host=appConfig.dirPaths.ajaxUrlParts.main),host}};return inst}]),angular.module("app").factory("appAuth",["appHttp","appConfig","$cookieStore","$location","$rootScope","$q","UserModel","jrgString","appNav","appStorage",function(appHttp,appConfig,$cookieStore,$location,$rootScope,$q,UserModel,jrgString,appNav,appStorage){var inst={data:{redirectUrl:!1,urlInfo:{page:!1,queryParams:!1,queryParamsObj:!1,curNavPage:!1}},inited:!1,init:function(params){this.inited||$rootScope.$on("$routeChangeStart",function(scope,next,current){$rootScope.$broadcast("evtLoadingStart",{})}),this.inited=!0},samePage:function(newUrl,params){return newUrl.indexOf(this.data.urlInfo.page)>-1?!0:!1},saveUrlLocation:function(params){var skipPages=["login","signup","user-delete","callback-twitter-auth","callback-facebook-auth","callback-google-auth"],appPath=appConfig.dirPaths.appPath,curUrl=$location.$$absUrl,ret1=jrgString.parseUrl({url:curUrl,rootPath:appPath}),curPage=ret1.page,queryParams=ret1.queryParams;this.data.urlInfo=angular.extend(this.data.urlInfo,ret1);for(var skip=!1,ii=0;ii<skipPages.length;ii++)if(curPage==skipPages[ii]){skip=!0;break}if(skip)this.data.redirectUrl=$cookieStore.get("redirectUrl");else{var queryParamsString=queryParams;queryParamsString.length>0&&(queryParamsString="?"+queryParamsString),curPage+=queryParamsString,this.data.redirectUrl=curPage,$cookieStore.put("redirectUrl",curPage)}},done:function(params){$rootScope.$broadcast("evtLoadingDone",{})},checkAuth:function(params,user,ppNew){var ret={valid:!0,redirectPage:""};return void 0!==params.auth&&(ret.valid&&void 0!==params.auth.loggedIn&&!ppNew.loggedIn&&(ret.valid=!1,void 0!==params.auth.loggedIn.exceptionUrlParamsRegex&&(ret.valid=this.checkUrlParams(params.auth.loggedIn.exceptionUrlParamsRegex,{})),ret.valid||(void 0===params.auth.loggedIn.redirect&&(params.auth.loggedIn.redirect="login"),ret.redirectPage=params.auth.loggedIn.redirect,$rootScope.$broadcast("changeLayoutEvt","login"))),!ret.valid||void 0===params.auth.member||user&&void 0!==user&&void 0!==user.status&&"guest"!=user.status||(ret.valid=!1,void 0!==params.auth.member.exceptionUrlParamsRegex&&(ret.valid=this.checkUrlParams(params.auth.member.exceptionUrlParamsRegex,{})),ret.valid||(ret.redirectPage=params.auth.member.redirect))),ret},checkUrlParams:function(urlParamsRegex,params){var xx,yy,pattern,regex,foundCount=0,matchCount=0,valid=!1;for(xx in urlParamsRegex)for(yy in this.data.urlInfo.queryParamsObj)xx==yy&&(pattern=urlParamsRegex[xx],regex=new RegExp(pattern),this.data.urlInfo.queryParamsObj[yy].match(regex)&&matchCount++,foundCount++);return matchCount>0&&(valid=!0),valid},handleLoginRequest:function(response,deferred,goTrig,params){var thisObj=this,user=response.result.user;UserModel.save(user),thisObj.preDone(deferred,goTrig,params,{loggedIn:!0,checkRedirectUrl:!0})},preDone:function(deferred,goTrig,params,ppNew){var thisObj=this,user=UserModel.load(),retAuth=thisObj.checkAuth(params,user,{loggedIn:ppNew.loggedIn});if(retAuth.goTrig=goTrig,retAuth.valid)if(ppNew.loggedIn===!1)thisObj.done({}),deferred.resolve(retAuth);else{$rootScope.$broadcast("loginEvt",{loggedIn:!0,noRedirect:!0,user_id:user._id,sess_id:user.sess_id});var ii,skipRedirect=!1,skipRedirectPages=["user-delete"];for(ii=0;ii<skipRedirectPages.length;ii++)if(thisObj.data.urlInfo.page==skipRedirectPages[ii]){skipRedirect=!0;break}if(void 0!==ppNew.checkRedirectUrl&&ppNew.checkRedirectUrl&&thisObj.data.redirectUrl&&!skipRedirect){$location.url(appConfig.dirPaths.appPathLocation+thisObj.data.redirectUrl);var redirectUrlSave=thisObj.data.redirectUrl;thisObj.data.redirectUrl=!1,$cookieStore.remove("redirectUrl"),thisObj.samePage(redirectUrlSave,{})?(thisObj.done({}),deferred.resolve(retAuth)):deferred.reject(retAuth)}else thisObj.done({}),deferred.resolve(retAuth)}else thisObj.samePage(retAuth.redirectPage,{})?(thisObj.done({}),deferred.resolve(retAuth)):deferred.reject(retAuth),$location.url(appConfig.dirPaths.appPathLocation+retAuth.redirectPage)},checkSess:function(params){var thisObj=this,defaults={};params=angular.extend(defaults,params);var promise1,deferred=$q.defer();this.saveUrlLocation({}),this.data.urlInfo.curNavPage=appNav.updateNav({urlInfo:this.data.urlInfo});var goTrig=!0;if(appConfig.state.loggedIn===!1){goTrig=!1;var promiseStorage=appStorage.read("user",{});promiseStorage.then(function(user){UserModel.save(user),thisObj.preDone(deferred,goTrig,params,{loggedIn:!0,checkRedirectUrl:!0})},function(err){var cookieSess=$cookieStore.get("sess_id"),cookieUser=$cookieStore.get("user_id");cookieUser&&cookieSess?(goTrig=!1,promise1=appHttp.go({},{url:"auth/active",data:{user_id:cookieUser,sess_id:cookieSess}},{}),promise1.then(function(response){thisObj.handleLoginRequest(response,deferred,goTrig,{})},function(response){$cookieStore.remove("sess_id"),$cookieStore.remove("user_id"),thisObj.preDone(deferred,goTrig,params,{loggedIn:!1})})):(goTrig=!0,thisObj.preDone(deferred,goTrig,params,{loggedIn:!1}))})}return goTrig&&thisObj.preDone(deferred,goTrig,params,{loggedIn:!0}),deferred.promise}};return inst.init({}),inst}]),angular.module("app").factory("appStorage",["$q",function($q){var inst={data:{user:!1},keys:[],save:function(key,val,params){var self=this;new Lawnchair(function(){self.keys.indexOf(key)<0&&self.keys.push(key),this.save({key:key,value:val})})},read:function(key,params){var deferred=$q.defer();return new Lawnchair(function(){var self=this;this.exists(key,function(exists){exists?self.get(key,function(obj){deferred.resolve(obj.value)}):deferred.reject({})})}),deferred.promise},delete1:function(key,params){var deferred=$q.defer(),self=this;return new Lawnchair(function(){if(void 0!==key&&key){var promise1=self.removeOne(key,{});promise1.then(function(ret1){deferred.resolve({})})}else{var ii,promises=[];for(ii=0;ii<self.keys.length;ii++)promises[ii]=self.removeOne(self.keys[ii],{});promises.length>0?$q.all(promises).then(function(ret1){deferred.resolve({})}):deferred.resolve({})}}),deferred.promise},removeOne:function(key,params){var deferred=$q.defer();return new Lawnchair(function(){this.remove(key,function(){deferred.resolve({})})}),deferred.promise}};return inst}]),angular.module("app").factory("appNavConfig",["appConfig","jrgArray",function(appConfig,jrgArray){var inst={historyBack:!1,inited:!1,pathRoot:"modules/services/nav/",paths:{},components:{},pages:{},pagesRouteMap:{},init:function(params){this.inited||(this.initPaths(params),this.initComponents({}),this.initPages(params),this.inited=!0)},initPaths:function(params){this.pathRoot=appConfig.dirPaths.staticPath+this.pathRoot,this.paths.templates={headerCentered:this.pathRoot+"header-centered/header-centered.html",footerFlex:this.pathRoot+"footer-flex/footer-flex.html"},this.paths.appPathLink=appConfig.dirPaths.appPathLink},initComponents:function(params){var self=this;this.components.backButton={icon:"fa fa-arrow-left",click:function(){self.historyBack({})}},this.components.headerCentered={template:this.paths.templates.headerCentered,title:{html:"[Title]"},buttons:{left:[this.components.backButton,{html:"Test",href:this.paths.appPathLink+"dev-test/test"}],right:[{icon:"fa fa-sign-in",iconHtml:"Login",href:this.paths.appPathLink+"login"}]}},this.components.footerMain={template:this.paths.templates.footerFlex,classes:{cont:""},buttons:[{html:"SocketIO",href:this.paths.appPathLink+"dev-test/socketio"},{icon:"fa fa-picture-o",href:this.paths.appPathLink+"dev-test/design"},{icon:"fa fa-bolt",iconHtml:"Test",href:this.paths.appPathLink+"dev-test/test"},{html:"Social",href:this.paths.appPathLink+"dev-test/social"}]},this.components.footerMainIndices={},this.components.defaultNav={header:this.components.headerCentered,footer:this.components.footerMain}},initPages:function(params){this.pages.defaultPage=jrgArray.copy(this.components.defaultNav),this.pages.login={header:{template:this.paths.templates.headerCentered,title:{html:"&nbsp;"},buttons:{left:[{html:"&nbsp;"}],right:[{html:"&nbsp;"}]}},footer:{template:this.paths.templates.footerFlex,buttons:[{html:"&nbsp;"}]}},this.pages.signup={header:{template:this.paths.templates.headerCentered,title:{html:"&nbsp;"},buttons:{left:[{html:"&nbsp;"}],right:[{html:"&nbsp;"}]}},footer:{template:this.paths.templates.footerFlex,buttons:[{html:"&nbsp;"}]}},this.pages.test=jrgArray.copy(this.components.defaultNav)}};return inst.init({}),inst}]),angular.module("app").factory("appNav",["$rootScope","jrgArray","appNavConfig","$window",function($rootScope,jrgArray,appNavConfig,$window){var selfGlobal,inst={inited:!1,initTrigs:{routeChange:!1},pathRoot:!1,paths:{},historyCounter:0,components:{},pages:{},curNav:!1,curPageKey:!1,pagesRouteMap:{},init:function(params){if(selfGlobal=this,!this.inited){this.initPaths(params),this.initComponents({}),this.initPages(params),this.inited=!0}},initPaths:function(params){this.pathRoot=appNavConfig.pathRoot,this.paths=appNavConfig.paths},initComponents:function(params){appNavConfig.historyBack=this.historyBack,this.components=appNavConfig.components},initPages:function(params){this.pages=appNavConfig.pages,this.pagesRouteMap=appNavConfig.pagesRouteMap},updateNav:function(params){var curPage;curPage=params.pageToUse?params.pageToUse:this.getPageFromRoute(params.urlInfo.page,{queryParamsObj:params.urlInfo.queryParamsObj}),this.curPageKey=curPage,this.curNav=this.pages[curPage],this.afterNavUpdated({});var pageToReturn;return pageToReturn="defaultPage"==curPage?params.urlInfo.page:curPage},afterNavUpdated:function(params){if(void 0!==this.curNav){var ii;if(void 0!==this.curNav.header&&void 0!==this.curNav.header.buttons){if(void 0!==this.curNav.header.buttons.left)for(ii=0;ii<this.curNav.header.buttons.left.length;ii++)void 0===this.curNav.header.buttons.left[ii].classes&&(this.curNav.header.buttons.left[ii].classes={}),void 0!==this.curNav.header.buttons.left[ii].icon&&void 0===this.curNav.header.buttons.left[ii].iconHtml&&(this.curNav.header.buttons.left[ii].classes.button="icon-only");if(void 0!==this.curNav.header.buttons.right)for(ii=0;ii<this.curNav.header.buttons.right.length;ii++)void 0===this.curNav.header.buttons.right[ii].classes&&(this.curNav.header.buttons.right[ii].classes={}),void 0!==this.curNav.header.buttons.right[ii].icon&&void 0===this.curNav.header.buttons.right[ii].iconHtml&&(this.curNav.header.buttons.right[ii].classes.button="icon-only")}if(void 0!==this.curNav.footer&&void 0!==this.curNav.footer.buttons)for(ii=0;ii<this.curNav.footer.buttons.length;ii++)void 0===this.curNav.footer.buttons[ii].classes&&(this.curNav.footer.buttons[ii].classes={}),void 0!==this.curNav.footer.buttons[ii].icon&&void 0===this.curNav.footer.buttons[ii].iconHtml&&(this.curNav.footer.buttons[ii].classes.button="icon-only")}this.broadcastNavUpdates({}),this.updateRouteChangeCounter({})},broadcastNavUpdates:function(params){$rootScope.$broadcast("appNavHeaderUpdate",{nav:this.curNav}),$rootScope.$broadcast("appNavFooterUpdate",{nav:this.curNav});var layoutClass="layout-"+this.curPageKey;$rootScope.$broadcast("changeLayoutEvt",layoutClass)},updateRouteChangeCounter:function(params){this.initTrigs.routeChange?this.historyCounter++:this.initTrigs.routeChange=!0},getNav:function(params){return jrgArray.copy(this.curNav,{})},setNav:function(newNav,params){this.curNav=newNav,this.afterNavUpdated({})},getPageFromRoute:function(urlPage,params){var regex,page=!1;void 0===params.queryParamsObj&&(params.queryParamsObj={});var urlPageSanitized=urlPage.replace(/[-_]/g,"").toLowerCase();if((void 0!==this.pages[urlPage]||void 0!==this.pages[urlPageSanitized])&&(page=urlPageSanitized),!page){var xx,qq,matchAll;for(xx in this.pagesRouteMap)if(void 0!==this.pagesRouteMap[xx].urlRegex&&(regex=new RegExp(this.pagesRouteMap[xx].urlRegex,""),urlPageSanitized.match(regex)&&(page=xx)),!page&&this.pagesRouteMap[xx].url==urlPageSanitized){if(void 0===this.pagesRouteMap[xx].params){page=xx;break}matchAll=!0;for(qq in this.pagesRouteMap[xx].params)if(void 0===params.queryParamsObj[qq]||params.queryParamsObj[qq]!==this.pagesRouteMap[xx].params[qq]){matchAll=!1;break}if(matchAll){page=xx;break}}}return page||(page="defaultPage"),page},historyBack:function(params){var self=selfGlobal;
self.historyCounter>0&&($window.history.back(),self.historyCounter=self.historyCounter-2)}};return inst.init({}),inst}]),angular.module("app").factory("appSocket",["socketFactory","appConfig",function(socketFactory,appConfig){var inst={inited:!1,sockets:{},init:function(params){this.inited||(this.inited=!0,this.sockets={test:socketFactory({ioSocket:io.connect(appConfig.dirPaths.serverPath+"test")})})}};return inst.init({}),inst}]),angular.module("app").factory("appErrorMsg",["jrgArray",function(jrgArray){var publicObj={getMessage:function(route,code,params){var ret={found:!1,msg:""};if(void 0!==messages[route]){var index1=jrgArray.findArrayIndex(messages[route],"code",code,{});index1>-1&&(ret.msg=messages[route][index1].msg,ret.found=!0)}return ret}},messages={"auth/login":[{code:2,msg:"Invalid email"},{code:1,msg:"Invalid password"}]};return publicObj}]),angular.module("app").directive("appAppalert",["$rootScope","$timeout",function($rootScope,$timeout){return{restrict:"A",scope:{},template:"<div class='app-appalert {{alert.classes}}'><alert type='alert.type' close='closeAlert({})'>{{alert.msg}}</alert></div>",controller:function($scope,$element,$attrs){function closeAlert(opts){resetAlert({}),hideAlert({noAnimate:!0})}function hideAlert(opts){var hidingTime=1250,defaults={delay:2e3};opts=angular.extend(defaults,opts),opts.noAnimate?$scope.alert.classes="hidden":timeoutAlert.hiding=$timeout(function(){$scope.alert.classes="hiding",timeoutAlert.hidden=$timeout(function(){$scope.alert.classes="hidden"},hidingTime)},opts.delay)}function resetAlert(opts){$timeout.cancel(timeoutAlert.hiding),$timeout.cancel(timeoutAlert.hidden)}function showAlert(opts){resetAlert({}),$scope.alert.classes="",hideAlert(opts)}$scope.alert={type:"",msg:"msg here!",classes:"hidden"};var timeoutAlert={hiding:!1,hidden:!1};$scope.closeAlert=function(opts){closeAlert({})},$rootScope.$on("evtAppalertAlert",function(evt,opts){opts.close||!opts.msg?closeAlert({}):($scope.alert.type=opts.type||"",$scope.alert.msg=opts.msg,showAlert(opts))})}}}]),angular.module("app").directive("appLogin",["appConfig",function(appConfig){return{restrict:"A",scope:{forgotPass:"&",login:"&"},template:function(element,attrs){var html="<div class='login-form center center-margin'><form class='jrg-forminput-form' name='loginForm' ng-submit='submitForm()'><div jrg-forminput type='email' placeholder='Email' ng-model='formVals.email' opts='' required></div><div ng-hide='forgotPassVisible'><div jrg-forminput type='password' placeholder='Password' ng-model='formVals.password' opts='' required ng-minlength='6'></div></div><div class='clearfix' ng-hide='forgotPassVisible'><div class='login-form-forgot-pass btn-link' ng-click='toggleForgotPass({})'>Forgot Password</div><button class='btn btn-primary login-form-button-right jrg-forminput-submit' type='submit' >Login</button></div><div class='clearfix' ng-show='forgotPassVisible'><div class='login-form-forgot-pass btn-link' ng-click='toggleForgotPass({})'>Back to Login</div><div class='jrg-forminput-submit btn btn-primary login-form-button-right' ng-click='forgotPassDtv({})' >Remind Me!</div></div><div app-social-auth-btn button-text='Login'></div></form></div><div class='center margin-tb'><span>Don't have an account with {{appTitle}}?</span> <a class='btn-link' ng-href='{{appPathLink}}signup'>Sign Up</a></div>";return html},controller:function($scope,$element,$attrs){$scope.appTitle=appConfig.cfgJson.app.title,$scope.appPathLink=appConfig.dirPaths.appPathLink,$scope.formVals={},$scope.submitForm=function(){if($scope.loginForm.$valid)if($scope.$emit("evtAppalertAlert",{close:!0}),void 0!==$scope.login&&void 0!==$scope.login()&&"function"==typeof $scope.login()){var ppSend={vals:$scope.formVals};$scope.login()(ppSend,function(){})}else console.log("$scope.login function undefined or not valid");else $scope.$emit("evtAppalertAlert",{type:"error",msg:"Please fill in all values!"})},$scope.forgotPassVisible=!1,$scope.forgotPassDtv=function(params){if($scope.forgotPassVisible=!0,void 0!==$scope.formVals.email&&$scope.formVals.email.length>1)if(void 0!==$scope.forgotPass&&void 0!==$scope.forgotPass()&&"function"==typeof $scope.forgotPass()){var ppSend={email:$scope.formVals.email};$scope.forgotPass()(ppSend,function(){})}else console.log("$scope.forgotPass function undefined or not valid");else $scope.$emit("evtAppalertAlert",{type:"error",msg:"Enter your email above to reset your password"})},$scope.toggleForgotPass=function(params){$scope.forgotPassVisible&&$scope.$emit("evtAppalertAlert",{close:!0}),$scope.forgotPassVisible=!$scope.forgotPassVisible}}}}]),angular.module("app").directive("appSignup",["appConfig",function(appConfig){return{restrict:"A",scope:{signup:"&"},template:function(element,attrs){var html="<div class='signup-form center center-margin'><form class='jrg-forminput-form' name='signupForm' ng-submit='submitForm()'><div jrg-forminput placeholder='Name' ng-model='formVals.name' opts='' required ng-minlength='5'></div><div jrg-forminput type='email' placeholder='Email' ng-model='formVals.email' opts='' required></div><div jrg-forminput type='password' placeholder='Password (6+ characters)' label='Password' ng-model='formVals.password' opts='' required ng-minlength='6'></div><div jrg-forminput type='password' placeholder='Password Again' ng-model='formVals.password_confirm' opts='' required></div><button class='btn btn-primary jrg-forminput-submit' type='submit' >Sign Up</button></form><div app-social-auth-btn button-text='Sign Up'></div></div><div class='center margin-tb'>Or <a class='btn-link' ng-href='{{appPathLink}}login'>Login</a></div>";return html},controller:function($scope,$element,$attrs){$scope.appTitle=appConfig.cfgJson.app.title,$scope.appPathLink=appConfig.dirPaths.appPathLink,$scope.formVals={},$scope.submitForm=function(){if($scope.signupForm.$valid)if($scope.formVals.password_confirm!=$scope.formVals.password)$scope.$emit("evtAppalertAlert",{type:"error",msg:"Passwords must match"});else if($scope.formVals.name.indexOf(" ")<0)$scope.$emit("evtAppalertAlert",{type:"error",msg:"Must enter a first and last name"});else{var valid=!0;$scope.$emit("evtAppalertAlert",{close:!0});var vals={email:$scope.formVals.email,password:$scope.formVals.password,password_confirm:$scope.formVals.password_confirm},minNameLength=2,posSpace=$scope.formVals.name.indexOf(" ");if(vals.first_name=$scope.formVals.name.slice(0,posSpace).trim(),vals.last_name=$scope.formVals.name.slice(posSpace+1,$scope.formVals.name.length).trim(),(vals.first_name.length<minNameLength||vals.last_name.length<minNameLength)&&($scope.$emit("evtAppalertAlert",{type:"error",msg:"Must enter a first and last name of at least "+minNameLength+" characters each"}),valid=!1),$scope.formVals.phone_number&&(vals.phone={area_code:"",number:$scope.formVals.phone_number,confirmed:0,primary:1}),valid){if(void 0!==$scope.signup&&void 0!==$scope.signup()&&"function"==typeof $scope.signup()){var params={vals:vals};$scope.signup()(params,function(){})}}else $scope.$emit("evtAppalertAlert",{type:"error",msg:"Please properly enter all values!"})}}}}}]),angular.module("app").directive("appSocialAuthBtn",["appHttp","UserModel","appConfig","$rootScope",function(appHttp,UserModel,appConfig,$rootScope){return{restrict:"A",scope:{},template:function(element,attrs){var defaultAttrs={buttonText:"Login"};attrs=angular.extend(defaultAttrs,attrs);var html="<div class='social-auth-btn-buttons center margin-t'><a class='a-div social-auth-btn-button-facebook' ng-href='{{fbLink}}'><i class='fa fa-facebook padding-lr social-auth-btn-button-icon'></i><div class='social-auth-btn-button-text'>Facebook</div></a><a class='a-div social-auth-btn-button-google' ng-href='{{googleLink}}'><i class='fa fa-google-plus padding-lr social-auth-btn-button-icon'></i><div class='social-auth-btn-button-text'>Google+</div></a><a class='a-div social-auth-btn-button-twitter' ng-href='{{twitterLink}}'><i class='fa fa-twitter padding-lr social-auth-btn-button-icon'></i><div class='social-auth-btn-button-text'>Twitter</div></a></div>";return html},controller:function($scope,$element,$attrs){function init(params){var publicPathNoSlash=appConfig.dirPaths.publicPath.slice(0,appConfig.dirPaths.publicPath.length-1),state="randState",redirectUri=publicPathNoSlash+appConfig.dirPaths.appPathLink+"callback-facebook-auth";$scope.fbLink="https://www.facebook.com/v2.0/dialog/oauth?client_id="+appConfig.cfgJson.facebook.appId+"&redirect_uri="+redirectUri+"&response_type=token&scope="+appConfig.cfgJson.facebook.scope+"&state="+state,appHttp.go({},{url:"twitter/requestToken",data:{}},{},{}).then(function(response){$scope.twitter.requestToken=response.result.request_token,$scope.twitter.requestTokenSecret=response.result.request_token_secret,$scope.twitterLink="https://api.twitter.com/oauth/"+twitterLinkPart+"?oauth_token="+$scope.twitter.requestToken}),redirectUri=publicPathNoSlash+appConfig.dirPaths.appPathLink+"callback-google-auth",state="randState";var ii,scopeArr=["https://www.googleapis.com/auth/plus.login","https://www.googleapis.com/auth/userinfo.email"],scope="";for(ii=0;ii<scopeArr.length;ii++)scopeArr[ii]=encodeURIComponent(scopeArr[ii]);scope=scopeArr.join(" "),$scope.googleLink="https://accounts.google.com/o/oauth2/auth?client_id="+appConfig.cfgJson.google.clientId+"&redirect_uri="+redirectUri+"&response_type=code&scope="+scope+"&state="+state+"&access_type=offline"}var twitterLinkPart="authorize";$scope.twitter={requestToken:!1,requestTokenSecret:!1},$scope.fbLink="",$scope.twitterLink="",$scope.googleLink="",init({})}}}]),angular.module("app").directive("appLayout",["$rootScope",function($rootScope){return{restrict:"A",scope:{ids:"=",contentMinHeight:"=",opts:"=?"},transclude:!0,template:function(element,attrs){var html="<div ng-transclude></div>";return html},controller:function($scope,$element,$attrs){function resize(params){if(document.getElementById(params.minHeightEleId)){for(var totHeight=window.innerHeight,nonFooterHeight=0,ii=0;ii<params.otherHeightEleIds.length;ii++){var curId=params.otherHeightEleIds[ii];curId!=params.minHeightEleId&&document.getElementById(curId)&&(nonFooterHeight+=document.getElementById(curId).offsetHeight)}var ele=document.getElementById(params.minHeightEleId),style=ele.currentStyle||window.getComputedStyle(ele),marginPaddingHeight=parseInt(style.marginTop,10)+parseInt(style.marginBottom,10)+parseInt(style.borderTopWidth,10)+parseInt(style.borderBottomWidth,10)+parseInt(style.paddingTop,10)+parseInt(style.paddingBottom,10);$scope.contentMinHeight=totHeight-nonFooterHeight-marginPaddingHeight,document.getElementById(params.minHeightEleId).style.minHeight=$scope.contentMinHeight+"px",$scope.$broadcast("footerResize",$scope.contentMinHeight)}}window.onresize=function(){resize({otherHeightEleIds:[$scope.ids.header,$scope.ids.content,$scope.ids.footer],minHeightEleId:$scope.ids.content})},$rootScope.$on("appLayoutResize",function(evt,params){resize({otherHeightEleIds:[$scope.ids.header,$scope.ids.content,$scope.ids.footer],minHeightEleId:$scope.ids.content})}),resize({otherHeightEleIds:[$scope.ids.header,$scope.ids.content,$scope.ids.footer],minHeightEleId:$scope.ids.content})}}}]),angular.module("myApp").controller("LayoutCtrl",["$scope","appConfig","$location","$cookieStore","$rootScope","appAuth",function($scope,appConfig,$location,$cookieStore,$rootScope,appAuth){$scope.appPath=appConfig.dirPaths.appPath,$scope.appPathLink=appConfig.dirPaths.appPathLink,$scope.appPathLocation=appConfig.dirPaths.appPathLocation,$scope.appPathImg=appConfig.dirPaths.appPath+"src/common/img",$scope.staticPath=appConfig.dirPaths.staticPath,$scope.pagesFullPath=appConfig.dirPaths.staticPath+appConfig.dirPaths.pagesPath,$scope.appTitle=appConfig.cfgJson.app.title,$scope.ids={header:"header",content:"content",footer:"footer"},$scope.classes={loggedIn:"logged-out",layout:"layout-login"},$scope.contentMinHeight=0,$scope.$on("loginEvt",function(evt,params){var appPath1=appConfig.dirPaths.appPath,locPathMatch=$location.path().replace(/^[//]+/g,""),appPath1Match=appPath1.replace(/^[//]/g,"");if(params.loggedIn){if($scope.classes.loggedIn="logged-in",appConfig.state.loggedIn=!0,void 0!==params.sess_id&&$cookieStore.put("sess_id",params.sess_id),void 0!==params.user_id&&$cookieStore.put("user_id",params.user_id),void 0===params.noRedirect||!params.noRedirect||params.loggedIn&&(locPathMatch==appPath1Match+"login"||locPathMatch==appPath1Match+"password-reset"||locPathMatch==appPath1Match+"signup")){var page="home",redirect=!1;appAuth.data.redirectUrl&&(appAuth.data.redirectUrl.indexOf("login")<0&&appAuth.data.redirectUrl.indexOf("password-reset")<0&&appAuth.data.redirectUrl.indexOf("signup")<0&&(page=appAuth.data.redirectUrl,redirect=!0),appAuth.data.redirectUrl=!1,$cookieStore.remove("redirectUrl"));var ppAdd="";page.indexOf("refresh=1")<0&&(ppAdd="refresh=1",ppAdd=page.indexOf("?")>-1?"&"+ppAdd:"?"+ppAdd),$location.url(appConfig.dirPaths.appPathLocation+page+ppAdd)}}else $scope.classes.loggedIn="logged-out",appConfig.state.loggedIn=!1,void 0!==params.noRedirect&&params.noRedirect&&locPathMatch!=appPath1Match+"login"&&locPathMatch!=appPath1Match+"password-reset"&&locPathMatch!=appPath1Match+"signup"||$location.url(appConfig.dirPaths.appPathLocation+"home")}),$scope.$on("changeLayoutEvt",function(evt,classPage,params){void 0===params&&(params={}),classPage&&($scope.classes.layout=classPage),void 0!==params.classLoggedIn&&($scope.classes.loggedIn=params.classLoggedIn),$rootScope.$broadcast("appLayoutResize",{})})}]),angular.module("myApp").controller("HeaderCtrl",["$scope","appNav","appConfig",function($scope,appNav,appConfig){function init(params){if(nav=appNav.getNav({}),void 0!==nav&&nav){var ppSend={};ppSend.loggedIn=appConfig.state.loggedIn,nav=navLoginUpdate(nav,ppSend),appNav.setNav(nav,{}),setNav(nav.header,{})}}function setNav(nav,params){void 0!==nav&&nav&&($scope.nav=nav,void 0!==$scope.nav.classes&&void 0!==$scope.nav.classes.cont&&"hidden"==$scope.nav.classes.cont?$scope.classes.cont=$scope.nav.classes.cont:$scope.classes.cont="")}function navLoginUpdate(nav,params){return params.loggedIn?nav.header.buttons.right[0]={icon:"fa fa-sign-out",iconHtml:"Logout",href:$scope.appPathLink+"logout"}:nav.header.buttons.right[0]={icon:"fa fa-sign-in",iconHtml:"Login",href:$scope.appPathLink+"login"},nav}$scope.nav={},$scope.classes={cont:""};var nav;$scope.$on("appNavHeaderUpdate",function(evt,params){setNav(params.nav.header,{})}),$scope.$on("loginEvt",function(evt,params){nav=appNav.getNav({}),nav=navLoginUpdate(nav,params),appNav.setNav(nav,{})}),init({})}]),angular.module("myApp").controller("FooterCtrl",["$scope","appNav",function($scope,appNav){function setNav(nav,params){void 0!==nav&&nav&&($scope.nav=nav,void 0!==$scope.nav.classes&&void 0!==$scope.nav.classes.cont&&"hidden"==$scope.nav.classes.cont?$scope.classes.cont=$scope.nav.classes.cont:$scope.classes.cont="")}$scope.nav={},$scope.classes={cont:""},$scope.$on("appNavFooterUpdate",function(evt,params){setNav(params.nav.footer,{})});var nav=appNav.getNav({});setNav(nav.footer,{})}]),angular.module("myApp").controller("HomeCtrl",["$scope",function($scope){}]),angular.module("myApp").controller("LoginCtrl",["$scope","appHttp","$location","UserModel","$rootScope",function($scope,appHttp,$location,UserModel,$rootScope){$scope.login=function(params,callback){var promise1=appHttp.go({},{url:"auth/login",data:params.vals},{});promise1.then(function(response){var user=response.result.user;UserModel.save(user),$rootScope.$broadcast("loginEvt",{loggedIn:!0,sess_id:user.sess_id,user_id:user._id}),callback({})})},$scope.forgotPass=function(params,callback){var promise=appHttp.go({},{url:"auth/forgotPassword",data:{email:params.email}},{});promise.then(function(response){$location.url($scope.appPathLocation+"password-reset"),callback({})})}}]),angular.module("myApp").controller("SignupCtrl",["$scope","appHttp","UserModel","$rootScope",function($scope,appHttp,UserModel,$rootScope){$scope.signup=function(params,callback){var promise1=appHttp.go({},{url:"auth/create",data:params.vals},{});promise1.then(function(response){var user=response.result.user;UserModel.save(user),$rootScope.$broadcast("loginEvt",{loggedIn:!0,sess_id:user.sess_id,user_id:user._id}),callback({})})}}]),angular.module("myApp").controller("PasswordResetCtrl",["$scope","$routeParams","$location","appHttp","UserModel",function($scope,$routeParams,$location,appHttp,UserModel){$scope.formVals={},void 0!==$routeParams.reset_key&&($scope.formVals.password_reset_key=$routeParams.reset_key),void 0!==$routeParams.email&&($scope.formVals.email=$routeParams.email),$scope.submitForm=function(){if($scope.passResetForm.$valid&&$scope.formVals.password==$scope.formVals.password_confirm){$scope.$emit("evtAppalertAlert",{close:!0}),$scope.formVals.reset_key=$scope.formVals.password_reset_key;var promise=appHttp.go({},{url:"auth/resetPassword",data:$scope.formVals},{});promise.then(function(response){var user=response.result.user;UserModel.save(user),$scope.$emit("loginEvt",{loggedIn:!0,sess_id:user.sess_id,user_id:user._id})})}else $scope.$emit("evtAppalertAlert",{type:"error",msg:"Password must be at least 6 characters and passwords must match"})}}]),angular.module("myApp").controller("LogoutCtrl",["$scope","$location","$cookieStore","appHttp","UserModel","$rootScope","appStorage",function($scope,$location,$cookieStore,appHttp,UserModel,$rootScope,appStorage){function init(params){var promise1=appHttp.go({},{url:"auth/logout",data:{user_id:user._id,sess_id:sessId}},{suppressErrorAlert:!0});promise1.then(function(data){clearData({}),$rootScope.$broadcast("loginEvt",{loggedIn:!1})},function(data){clearData({}),$rootScope.$broadcast("loginEvt",{loggedIn:!1})})}function clearData(params){$cookieStore.remove("sess_id"),$cookieStore.remove("user_id"),UserModel.destroy(),appStorage.delete1()}var user=UserModel.load(),sessId=$cookieStore.get("sess_id");init({})}]),angular.module("myApp").controller("UserDeleteCtrl",["$scope","$location","appHttp","UserModel","$routeParams",function($scope,$location,appHttp,UserModel,$routeParams){var user=UserModel.load(),dataUser=user,promise1=appHttp.go({},{url:"user/delete1",data:{user_id:dataUser._id}},{});promise1.then(function(data){$location.url($scope.appPathLocation+"logout")})}]),angular.module("myApp").controller("CallbackTwitterAuthCtrl",["$scope","appHttp","UserModel","$rootScope","$routeParams",function($scope,appHttp,UserModel,$rootScope,$routeParams){function init(params){void 0!==$routeParams.oauth_token&&void 0!==$routeParams.oauth_verifier?twitterAccessToken({}):alert("missing required URL params")}function twitterAccessToken(params){var vals={oauth_verifier:$routeParams.oauth_verifier};appHttp.go({},{url:"twitter/accessToken",data:vals},{},{}).then(function(response){var user=response.result.user;UserModel.save(user),$rootScope.$broadcast("loginEvt",{loggedIn:!0,sess_id:user.sess_id,user_id:user._id})})}init({})}]),angular.module("myApp").controller("CallbackFacebookAuthCtrl",["$scope","appHttp","UserModel","$rootScope","$location","appConfig",function($scope,appHttp,UserModel,$rootScope,$location,appConfig){function init(params){var ii,hashPieces,hashArr=$location.hash().split("&"),hashParams={};for(ii=0;ii<hashArr.length;ii++)hashPieces=hashArr[ii].split("="),hashParams[hashPieces[0]]=hashPieces[1];void 0!==hashParams.access_token&&void 0!==hashParams.state?facebookAccessToken(hashParams):alert("missing required URL (hash) params")}function facebookAccessToken(params){var vals={access_token:params.access_token};appHttp.go({},{url:"facebook/me",data:vals},{},{}).then(function(response){var user=response.result.user;UserModel.save(user),$rootScope.$broadcast("loginEvt",{loggedIn:!0,sess_id:user.sess_id,user_id:user._id})})}init({})}]),angular.module("myApp").controller("CallbackGoogleAuthCtrl",["$scope","appHttp","UserModel","$rootScope","$location","appConfig",function($scope,appHttp,UserModel,$rootScope,$location,appConfig){function init(params){var stateMatch="randState",urlParams=$location.search();void 0!==urlParams.state&&urlParams.state==stateMatch?void 0!==urlParams.code?googleAccessToken(urlParams.code,{}):alert("missing code URL param"):alert("state not valid")}function googleAccessToken(code,params){var vals={code:code};appHttp.go({},{url:"google/auth",data:vals},{},{}).then(function(response){var user=response.result.user;UserModel.save(user),$rootScope.$broadcast("loginEvt",{loggedIn:!0,sess_id:user.sess_id,user_id:user._id})})}init({})}]),angular.module("myApp").controller("TestCtrl",["$scope","$timeout","appHttp","UserModel","$location",function($scope,$timeout,appHttp,UserModel,$location){$scope.user=UserModel.load(),$scope.swipeIt=function(evt,direction,params){console.log("swipe: "+direction)},$scope.tapIt=function(evt,params){console.log("tap")}}]),angular.module("myApp").controller("DesignCtrl",["$scope",function($scope){$scope.colors=[{"class":"blue"},{"class":"blueDark"},{"class":"green"},{"class":"red"},{"class":"yellow"},{"class":"orange"},{"class":"pink"},{"class":"purple"},{"class":"warningText"},{"class":"errorText"},{"class":"successText"},{"class":"infoText"}]}]),angular.module("myApp").controller("SocketioCtrl",["$scope","appSocket",function($scope,appSocket){$scope.socketData=[],$scope.formVals={};var socket=appSocket.sockets.test;socket.on("connect",function(){console.log("socket connected on channel: test")}),socket.on("doStuff",function(data){console.log("socket.on event: doStuff"),$scope.socketData=[data.data].concat($scope.socketData)}),$scope.addMessage=function(params){socket.emit("doStuff",{msg:$scope.formVals.socketMsg}),$scope.formVals.socketMsg=""}}]),angular.module("myApp").controller("SocialCtrl",["$scope","appConfig","appHttp","UserModel",function($scope,appConfig,appHttp,UserModel){$scope.user=UserModel.load(),$scope.shareFacebookFeed=function(){if(void 0!==$scope.user.social&&void 0!==$scope.user.social.facebook){var urlBase=appConfig.dirPaths.publicPath,vals={message:"My message!",link:urlBase+"dev-test/social",picture:urlBase+"src/common/img/ie-chrome-logo.png",name:"name!",caption:"caption!",description:"description!",user_id:$scope.user._id};appHttp.go({},{url:"facebook/publishUserFeed",data:vals},{}).then(function(response){$scope.$emit("evtAppalertAlert",{type:"success",msg:"Posted to Facebook!"})})}else $scope.$emit("evtAppalertAlert",{type:"error",msg:"No user.social.facebook login/token yet! Login with Facebook first."})},$scope.shareTwitter=function(){if(void 0!==$scope.user.social&&void 0!==$scope.user.social.twitter){var urlBase="src/common/img",vals={user_id:$scope.user._id,tweet_text:"my tweet!",pictures:[urlBase+"/ie-chrome-logo.png"]};appHttp.go({},{url:"twitter/tweetWithPicture",data:vals},{}).then(function(response){$scope.$emit("evtAppalertAlert",{type:"success",msg:"Posted to Twitter!"})})}else $scope.$emit("evtAppalertAlert",{type:"error",msg:"No user.social.twitter login/token yet! Login with Twitter first."})}}]),angular.module("myApp").controller("E2eCtrl",["$scope","$cookieStore","UserModel","appConfig","$rootScope",function($scope,$cookieStore,UserModel,appConfig,$rootScope){$rootScope.$broadcast("debugDataUpdate",{data:"E2eCtrl: appConfig.state.loggedIn: "+appConfig.state.loggedIn}),$scope.user=UserModel.load(),$scope.cookies={};var cookieSess=$cookieStore.get("sess_id"),cookieUser=$cookieStore.get("user_id");cookieUser&&($scope.cookies.user=cookieUser),cookieSess&&($scope.cookies.sess=cookieSess)}]);